{% extends 'monTemplate.html.twig' %}

{% block extra_js %}
<script src="{{ asset('js/jquery.collection.js') }}"></script>
<script src="{{ asset('js/sisyphus.js') }}"></script>
{% endblock %}

{% block sidebar %}

<body class="is-preload">
  <!-- Sidebar -->
  <section id="sidebar">
    <div class="inner">
      <nav>
        <ul>
          <li><a href="{{path('hub')}}">RETOUR</a></li>
        </ul>
      </nav>
    </div>
  </section>
  {% endblock %}

  {% block body %}
  <!-- Wrapper -->
  <div id="wrapper">

    <!-- Intro -->
    <section id="partie" class="wrapper style1 fullscreen fade-up">
      <div class="inner">
        {% if action == 'creer' %}
        <h1>CREER UN PLATEAU</h1>

        <section id="three" class="wrapper style1 fade-up">
          <div class="inner">

            {% form_theme vueFormulaireCreationPlateau with
              ['form/form-theme.html.twig',
              'jquery.collection.html.twig']   %}
              <div class="inner" id="ensembleformulaire">
                {{form_start(vueFormulaireCreationPlateau, {'attr': {'id': 'form_plateau'}}) }}
                {{ form_row(vueFormulaireCreationPlateau.nom)}}
                {{ form_row(vueFormulaireCreationPlateau.description)}}
                {{ form_row(vueFormulaireCreationPlateau.nbPion,  { 'label' : 'Nombre de pions' })}}
                {{ form_row(vueFormulaireCreationPlateau.nbFaceDe,  { 'label' : 'Nombre de faces du dé' })}}
                {{ form_row(vueFormulaireCreationPlateau.niveauDifficulte, { 'label' : 'Niveau de difficulté' })}}


                <h3>Cases/Défis</h3>
                <blockquote>Veuillez saisir entre 6 et 31 descriptifs</blockquote>


                <div id="ensemblecases">

                  {{ form_row(vueFormulaireCreationPlateau.cases) }}
                </div>
              </div>
              <div id="ensemblenumero">

              </div>

            </div>
            <Br>



          </div>

          {{form_end(vueFormulaireCreationPlateau)}}



          <div class="row">
            <div class="col-md-12">
              <a href="" class="button submit">Valider la création </a>
              <a href="{{ path('hub')}}" class="button scrolly">Annuler la création </a>
            </div>
          </div>

          {%else%}

          <h1>MODIFIER UN PLATEAU</h1>
          <section id="three" class="wrapper style1 fade-up">
            <div class="inner">

              {{form_start(vueFormulaireCreationPlateau) }}
              {{ form_row(vueFormulaireCreationPlateau.nom)}}
              {{ form_row(vueFormulaireCreationPlateau.description)}}
              {{ form_row(vueFormulaireCreationPlateau.niveauDifficulte, { 'label' : 'Niveau de difficulté' })}}

              <Br>


                <div class="row">
                  <div class="col-md-12">
                    <a href="" class="button submit">Valider la modification </a>
                    <a href="{{ path('parametres_plateau', {'idPlateau' : plateau.id}) }}" class="button scrolly">Annuler la modification </a>
                  </div>
                </div>

              </div>

              {{form_end(vueFormulaireCreationPlateau)}}




              {% endif %}

            </div>



            <script type="text/javascript">
              document.addEventListener("DOMContentLoaded", function(event) {

                $('.collection-cases').collection({
                  prefix: 'cases',
                  max: 31,
                  min: 6,
                  fade_in: true,
                  fade_out: true,
                  position_field_selector: '.position-case',

                  //fonctions déclenchées après l'ajout, la suppression et le déplacement d'une case
                  after_add:

                  //Fonction qui attribue un chiffre pour chaque élément numéro en fonction de sa position dans la liste
                  function majIndex(collection){
                    var k;
                    listenumero = document.getElementsByName('numero');
                    for(k=0; k<listenumero.length; k++){
                      listenumero[k].textContent=k+1;
                      nombreCases= k+1;
                    };
                    localStorage.setItem("form_plateau", collection[0].outerHTML);
                  },

                  after_remove:

                  function majIndex(collection){
                    var k;
                    listenumero = document.getElementsByName('numero');
                    for(k=0; k<listenumero.length; k++){
                      listenumero[k].textContent=k+1;
                      nombreCases= k+1;
                    };
                    localStorage.setItem("form_plateau", collection[0].outerHTML);
                  },


                  after_up:

                  function majIndex(collection){
                    var k;
                    listenumero = document.getElementsByName('numero');
                    for(k=0; k<listenumero.length; k++){
                      listenumero[k].textContent=k+1;
                    };
                    localStorage.setItem("form_plateau", collection[0].outerHTML);
                  },

                  after_down:

                  function majIndex(collection){
                    var k;
                    listenumero = document.getElementsByName('numero');
                    for(k=0; k<listenumero.length; k++){
                      listenumero[k].textContent=k+1;
                    };
                    localStorage.setItem("form_plateau", collection[0].outerHTML);
                  },

                  after_init:

                  function restoreData(collection){
                    collection[0].outerHTML = localStorage.getItem("form_plateau");
                  },

                });

              });












            </script>




            {% endblock %}




            {% block footer %}
            {% endblock %}
