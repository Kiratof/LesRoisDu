{% extends 'monTemplate.html.twig' %}



  {% block body %}
  <!-- Wrapper -->
  <div id="wrapper">

    <!-- Intro -->
    <section id="partie" class="wrapper style1 fullscreen fade-up">
      <div class="inner">
        <h1>SAISIR LES DEFIS <br>{{plateau.nom}}</h1>
        <section id="three" class="wrapper style1 fade-up">
          <div class="inner">

            {% if cases is null %}



                        <form id="defisForm" action="{{path('creation_cases', {'idPlateau': plateau.id})}}" method="post" >


                         <div class="inner" id="ensemblecases">
                         {% for i in 1..plateau.nbCases %}

                                 <div class="inner" id=unecase>
                                 <label for="descriptif{{i}}">Descriptif de la case n°{{i}}</label>
                                 <input type="text" name="descriptif{{i}}" id="descriptif{{i}}" minlength=10 maxlength=100 placeholder="Saisir le descriptif du défi." required>
                                 <BR>
                                 </div>

                               {% endfor %}
                         </div>

            <Br>

          <div class="row">
                    <div class="col-md-12">
             <input type="submit" href="" class="button" name="Valider ">
             <a href="{{ path('espace_plateau')}}" class="button scrolly">Annuler</a>
          </div>
        </div>
                </form>

          {% else %}

                        <form id="defisForm" action="{{path('modification_cases', {'idPlateau': plateau.id})}}" method="post" >

                        {% for case in cases %}


            <label for="descriptif{{case.numero}}">Descriptif de la case n°{{case.numero}}</label>
            <input type="text" name="descriptif{{case.numero}}" id="descriptif{{case.numero}}" minlength=10 maxlength=100 placeholder="Saisir le descriptif du défi." value="{{case.descriptifDefi}}" required>
            <BR>


            {% endfor %}

            <Br>

          <div class="row">
                    <div class="col-md-12">
             <input type="submit" href="" class="button" name="Valider ">
             <a href="{{ path('parametres_plateau', {'idPlateau' : plateau.id}) }}" class="button scrolly">Annuler</a>
          </div>
        </div>
                </form>

          {% endif %}
          <button class="button" onclick="ajoutDivCase()" id="ajouterCase">Ajouter une case</button>
          </div>


      </div>
    </section>
  </div>
  </section>

  </div>

  <script type="text/javascript">

function faireScroll(){
  var divPrincipale = document.getElementById("wrapper");
  divPrincipale.scrollTop = divPrincipale.scrollHeight;
}

function ajoutDivCase(){
  //récuperer la div qui englobe toutes les cases à saisir
  ensemblecases = document.getElementById('ensemblecases');



  //Changer le numéro dans la description
    //on récupère la dernière description du dernier element de la div ensemblecases
    descriptifDernierElement = ensemblecases.lastChild.textContent;
    //on recupere la div de la derniere case
    divDerniereCase = ensemblecases.lastElementChild;
    //on clone la derniere case ainsi que son contenu pour créer la nouvelle case
    nouvelleCase = divDerniereCase.cloneNode(true);

    //faire apparaitre la nouvelle case
    ensemblecases.appendChild(nouvelleCase);

    //on récupère le descriptif de la nouvelle case
    descriptifNouvelleCase = nouvelleCase.textContent;
      //on sépare le texte de la dernière case avec ° en tant que séparateur, le string devient tableau
      descriptifDernierElementArray = descriptifDernierElement.split("°");
      //on sépare le texte de la nouvelle case avec ° en tant que séparateur, le string devient tableau
      descriptifNouvelleCaseArray = descriptifNouvelleCase.split("°");
      //on incrémente le numéro dans la description
    	descriptifNouvelleCaseArray[1]++;
      //le tableau devient string
    	descriptifNouvelleCase = descriptifNouvelleCaseArray.join();
      //correction car le "°" devenait un "," suite aux transformations (bug?)
      descriptifNouvelleCase = descriptifNouvelleCase.replace(',','°');

    //mettre un id unique pour chaque input (une case=1 input)
      nouvelleCase.children[1].id="descriptif"+descriptifNouvelleCaseArray[1]++;

    //on renvoie au DOM /!\ MIS EN COMMENTAIRE CAR SINON LA DESCRIPTION CHANGE BEL ET BIEN MAIS LE INPUT DISPARAIT
    nouvelleCase.children[0].textContent = descriptifNouvelleCase;


}
</script>

  {% endblock %}


  {% block footer %}
  {% endblock %}
